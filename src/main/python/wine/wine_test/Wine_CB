import pandas as pd
import os
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

# Load the bank dataset
csv_path = os.path.abspath(os.path.join(os.path.dirname(__file__), '../../../resources/datasets', 'adult.csv'))
df = pd.read_csv(csv_path, sep=',')

# Calcola la correlazione tra le feature
corr_matrix = df.corr()

# Genera una heatmap della matrice di correlazione
plt.figure(figsize=(12, 10))
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm')
plt.title('Correlation Matrix')
plt.show()

# Seleziona le feature che superano una soglia di correlazione
threshold = 0.5
high_corr_features = np.where(corr_matrix.abs() > threshold)
high_corr_features = [(corr_matrix.index[x], corr_matrix.columns[y]) for x, y in zip(*high_corr_features) if x != y and x < y]

# Stampa le feature correlate
print("Feature correlate:")
for feature in high_corr_features:
    print(feature)
